<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>초등학생 로봇교육 통합 안내 · 신청</title>
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root{--max:1100px}
    body{font-family:'Noto Sans KR',sans-serif}
    .container{max-width:var(--max);margin:0 auto;padding:1rem}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .tags span{display:inline-block;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:.2rem .6rem;margin:.1rem;font-size:.8rem}
    dialog{max-width:360px}
    .hint{font-size:.85rem;color:#6b7280}
  </style>
</head>
<body>
  <header class="container">
    <nav>
      <ul>
        <li><strong>초등학생 로봇교육 통합 안내</strong></li>
      </ul>
      <ul>
        <li><button id="openQR">QR 코드 저장</button></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <article>
      <h2>프로그램 한눈에 보기 (4개)</h2>
      <p class="hint">각 카드의 <strong>신청하기</strong> 버튼은 프로그램별 <strong>개별 Google Form</strong>으로 이동합니다. (지금은 URL 미기재 상태)</p>
    </article>

    <section id="programGrid" class="grid"></section>

    <article>
      <details>
        <summary><strong>관리자 안내</strong> (Google Form URL 추가 방법)</summary>
        <ol>
          <li>아래 <code>PROGRAMS</code> 목록의 <code>formUrl</code>을 <code>https://forms.gle/...</code> 로 바꿔주세요.</li>
          <li>URL이 <code>_______</code> 를 포함하면 버튼이 자동으로 <em>신청 링크 준비중</em>으로 표시됩니다.</li>
          <li>GitHub Pages: 이 파일을 <code>index.html</code>로 저장소에 업로드 → Settings &gt; Pages에서 배포.</li>
          <li>Google Apps Script: 이 파일 내용을 <code>index</code>(HTML 파일)에 붙여넣고, <code>Code.gs</code>는 아래 예시로 배포.</li>
        </ol>
      </details>
    </article>
  </main>

  <dialog id="qrDialog">
    <article>
      <header>
        <button aria-label="Close" rel="prev" id="closeQR">닫기</button>
        <p><strong>이 페이지 QR 코드</strong></p>
      </header>
      <div id="qrcode" style="display:flex;justify-content:center;align-items:center"></div>
      <footer>
        <button id="saveQR">PNG로 저장</button>
      </footer>
    </article>
  </dialog>

  <script>
  const PROGRAMS = [
    {
      id: 'iot',
      title: 'IoT 센서블럭 실습 및 코딩',
      grade: '초1–초3 (20명)',
      formUrl: 'https://forms.gle/_______',
      tags: ['IoT', '언플러그드', 'AI 음성인식', '알버트', '블록코딩']
    },
    {
      id: 'tpbot',
      title: 'TPBot과 AI렌즈',
      grade: '초1–초3 (20명)',
      formUrl: 'https://forms.gle/_______',
      tags: ['TPBot', 'AI 렌즈', '마이크로비트', '라인트레킹', '장애물감지', '색/숫자/화살표 인식']
    },
    {
      id: 'rms1',
      title: '로봇 블록 코딩',
      grade: '초4–초6 (20명)',
      formUrl: 'https://forms.gle/_______',
      tags: ['RoboMaster S1', '스크래치', '순차/반복/조건', '로봇 제어']
    },
    {
      id: 'drone',
      title: '코딩으로 즐기는 드론',
      grade: '초4–초6 (20명)',
      formUrl: 'https://forms.gle/_______',
      tags: ['드론', '블록코딩', '미션', '장애물 회피']
    }
  ];

  function render(list){
    const grid=document.getElementById('programGrid');
    grid.innerHTML='';
    list.forEach(p=>{
      const url = (p.formUrl||'').trim();
      const waiting = url.includes('_______') || url==='' || url === '#';
      grid.insertAdjacentHTML('beforeend', `
        <article>
          <header><strong>${p.title}</strong></header>
          <p>대상: ${p.grade}</p>
          <div class="tags">${p.tags.map(t=>`<span>#${t}</span>`).join('')}</div>
          <p>
            <a href="${waiting ? '#' : url}" target="${waiting ? '' : '_blank'}"
               role="button" ${waiting ? 'aria-disabled="true" class="secondary outline"' : ''}>
               ${waiting ? '신청 링크 준비중' : '신청하기 (Google Form)'}
            </a>
          </p>
        </article>
      `);
    });
  }
  document.addEventListener('DOMContentLoaded',()=>render(PROGRAMS));
  </script>

  <!-- QR 코드 라이브러리 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    const openBtn=document.getElementById('openQR');
    const dlg=document.getElementById('qrDialog');
    const closeBtn=document.getElementById('closeQR');
    const saveBtn=document.getElementById('saveQR');
    let qr=null;
    openBtn.addEventListener('click',()=>{dlg.showModal();const box=document.getElementById('qrcode');box.innerHTML='';qr=new QRCode(box,{text:window.location.href,width:240,height:240});});
    closeBtn.addEventListener('click',()=>dlg.close());
    saveBtn.addEventListener('click',()=>{
      const img=document.querySelector('#qrcode img');
      const canvas=document.querySelector('#qrcode canvas');
      const src=(img&&img.src)||(canvas&&canvas.toDataURL('image/png'));
      if(!src) return;const a=document.createElement('a');a.href=src;a.download='robot-edu-qr.png';a.click();
    });
  </script>
</body>
</html>
